filter {
  if ([event][module]){
    mutate { add_field => { "[@metadata][tech]" => "-%{[event][module]}" } }
  } else{
    mutate { add_field => { "[@metadata][tech]" => "" } }
  }
}


output {
  if ([@metadata][pipeline]) {
    elasticsearch {
      cloud_id => "${CLOUD_ID}"
      cloud_auth => "${CLOUD_AUTH}"
      manage_template => false
      #pipeline => "%{[@metadata][pipeline]}"
      index => "datalake-${CUSTOMERNAME}"
    }
  } else {
    elasticsearch {
      cloud_id => "${CLOUD_ID}"
      cloud_auth => "${CLOUD_AUTH}"
      manage_template => false
      index => "datalake-${CUSTOMERNAME}"
    }
  }
}
